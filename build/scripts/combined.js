function addCommas(e){e+="";for(var t=e.split("."),a=t[0],i=t.length>1?"."+t[1]:"",s=/(\d+)(\d{3})/;s.test(a);)a=a.replace(s,"$1,$2");return a+i}function camelize(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")}var allLayers,renderer;require(["esri/map","esri/InfoTemplate","esri/renderers/UniqueValueRenderer","esri/symbols/PictureMarkerSymbol","esri/symbols/SimpleFillSymbol","esri/symbols/SimpleLineSymbol","esri/Color","dojo/domReady!"],function(e,t,a,i,s,n,o){var r=new s(s.STYLE_NULL,new n(n.STYLE_NULL,new o([85,255,0,1])),new o([85,255,0,.54])),l=new s(s.STYLE_NULL,new n(n.STYLE_NULL,new o([61,196,255]),2),new o([61,196,255,2])),c=new s(s.STYLE_NULL,new n(n.STYLE_NULL,new o([225,0,0]),2),new o([255,0,0,2])),d=new s(s.STYLE_NULL,new n(n.STYLE_NULL,new o([255,255,190,0])),new o([255,255,190,.54])),p=new s(s.STYLE_NULL,new n(n.STYLE_NULL,new o([38,115,0]),2),new o([38,115,0,.25])),u=new s(s.STYLE_NULL,new n(n.STYLE_NULL,new o([255,0,0,.25])),new o([255,0,0,.25])),m=new a(r,"Change_Type");m.addValue("Addition",l),m.addValue("Removal",c),m.addValue("No Change",d),m.addValue("Reclassification to System Unit",u),m.addValue("Reclassification to OPA",p);var r=new s(s.STYLE_NULL,new n(n.STYLE_NULL,new o([85,255,0,1])),new o([85,255,0,.54])),g=new s(s.STYLE_SOLID,new n(n.STYLE_SOLID,new o([255,0,0,.25])),new o([255,0,0,.25])),y=new s(s.STYLE_SOLID,new n(n.STYLE_SOLID,new o([190,225,232,1])),new o([255,0,0,.25])),f=new a(r,"Unit_Type");f.addValue("System Unit",g),f.addValue("Otherwise Protected Area",y)});var map,allLayers,maxLegendHeight,maxLegendDivHeight,printCount=0,legendLayers=[],measurement,queryTask,query,polyClicked=!1,printing=!1,sources,measuring=!1;require(["esri/map","esri/arcgis/utils","esri/config","esri/dijit/Geocoder","esri/dijit/HomeButton","esri/dijit/Legend","esri/dijit/LocateButton","esri/dijit/Measurement","esri/dijit/PopupTemplate","esri/dijit/Search","esri/graphic","esri/graphicsUtils","esri/geometry/Extent","esri/geometry/Multipoint","esri/geometry/Point","esri/geometry/Polygon","esri/layers/ArcGISTiledMapServiceLayer","esri/layers/FeatureLayer","esri/dijit/LayerSwipe","esri/renderers/UniqueValueRenderer","esri/SpatialReference","esri/symbols/PictureMarkerSymbol","esri/tasks/GeometryService","esri/tasks/FindTask","esri/tasks/FindParameters","esri/tasks/FindResult","esri/tasks/IdentifyParameters","esri/tasks/IdentifyTask","esri/InfoTemplate","esri/tasks/query","esri/tasks/QueryTask","esri/tasks/LegendLayer","esri/tasks/PrintTask","esri/tasks/PrintParameters","esri/tasks/PrintTemplate","esri/geometry/webMercatorUtils","esri/urlUtils","esri/layers/LabelClass","esri/symbols/TextSymbol","esri/symbols/Font","esri/Color","dojo/_base/array","dojo/dom","dojo/dom-class","dojo/dnd/Moveable","dojo/query","dojo/on","dojo/domReady!"],function(e,t,a,i,s,n,o,r,l,c,d,p,u,m,g,y,f,h,b,v,w,L,k,S,T,_,x,U,C,q,D,M,P,I,O,E,R,j,F,N,H,B,z,G,Y,A,W){function V(){$("#printModal").modal("show")}function Q(){function e(e){printCount++;var t=$("<p><label>"+printCount+': </label>&nbsp;&nbsp;<a href="'+e.url+'" target="_blank">'+n+" </a></p>");$("#printJobsDiv").find("p.toRemove").remove(),$("#printModalBody").append(t),$("#printTitle").val(""),$("#printExecuteButton").button("reset"),allLayers[1].setVisibility(!0),printing=!1}function t(e){alert("Sorry, an unclear print error occurred. Please try refreshing the application to fix the problem"),allLayers[1].setVisibility(!0),$("#printExecuteButton").button("reset"),gtag("event","click",{event_category:"Print",event_label:"Print Error"})}var a=new I;a.map=map,allLayers[1].setVisibility(!1);var i=new O;i.exportOptions={width:500,height:400,dpi:300},i.format="PDF",i.layout="Letter ANSI A Landscape cbrs projects",i.preserveScale=!1;var s=$("#printTitle").val();""==s?i.layoutOptions={titleText:"CBRS Project Mapper Excerpt",authorText:"Coastal Barrier Resources System (CBRS)",copyrightText:"This page was produced by the CBRS Projects Mapper"}:i.layoutOptions={titleText:s,authorText:"Coastal Barrier Resources System (CBRS)",copyrightText:"This page was produced by the CBRS Projects Mapper"};var n=i.layoutOptions.titleText;a.template=i;var o=new P("https://fwsprimary.wim.usgs.gov/server/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task");o.execute(a,e,t),gtag("event","click",{event_category:"Print",event_label:"successful Print"})}function X(e,t){var a;document.getElementById&&(a=document.getElementById(e))&&a.style&&(a.style.cursor=t)}map=new e("mapDiv",{basemap:"gray",extent:new u(-12567e3,2726e3,-5053e3,5529e3,new w({wkid:3857})),showLabels:!0});var K=new h("https://services1.arcgis.com/Hp6G80Pky0om7QvQ/arcgis/rest/services/InternalProjectsMapper/FeatureServer/3",{outFields:["*"]}),Z=new h("https://services1.arcgis.com/Hp6G80Pky0om7QvQ/arcgis/rest/services/InternalProjectsMapper/FeatureServer/1",{outFields:["*"]}),J=new h("https://services1.arcgis.com/Hp6G80Pky0om7QvQ/arcgis/rest/services/InternalProjectsMapper/FeatureServer/0",{outFields:["*"]}),ee=new h("https://services1.arcgis.com/Hp6G80Pky0om7QvQ/arcgis/rest/services/InternalProjectsMapper/FeatureServer/2",{outFields:["*"]}),te=new h("https://services1.arcgis.com/Hp6G80Pky0om7QvQ/arcgis/rest/services/InternalProjectsMapper/FeatureServer/4",{outFields:["*"],opacity:.6,dataAttributes:["Cong_Dist"]}),ae=new h("https://services1.arcgis.com/Hp6G80Pky0om7QvQ/arcgis/rest/services/InternalProjectsMapper/FeatureServer/5",{outFields:["*"],opacity:0}),ie=new H("black"),se=(new F).setColor(ie);se.font.setSize("10pt"),se.font.setFamily("sans-serif"),se.font.setWeight(N.WEIGHT_BOLD),se.setHaloColor(new H("#f0c0bb")),se.setHaloSize(2);var ne={labelExpressionInfo:{value:"CD: {Cong_Dist}"}},oe=new j(ne);oe.symbol=se,te.setLabelingInfo([oe]);var re=[];allLayers=re,a.defaults.io.corsEnabledServers.push("fwsprimary.wim.usgs.gov"),esri.config.defaults.io.proxyUrl="https://fwsprimary.wim.usgs.gov/serviceProxy/proxy.ashx",a.defaults.geometryService=new k("https://fwsmapper.wim.usgs.gov/arcgis/rest/services/Utilities/Geometry/GeometryServer");var le=new s({map:map,extent:new u(-12567e3,2726e3,-5053e3,5529e3,new w({wkid:3857}))},"homeButton");le.startup();var ce=new o({map:map,scale:4514},"locateButton");ce.startup(),measurement=new r({map:map,advancedLocationUnits:!0},z.byId("measurementDiv")),measurement.startup(),$(document).ready(function(){function e(){$("#aboutModal").modal("show"),gtag("event","click",{event_category:"About Modal",event_label:"About modal opened"})}$("#IEwarnContinue").click(function(){$("#disclaimerModal").modal("show")}),$("#existingInfo").click(function(){$("#existingModal").modal("show")}),$("#revisedInfo").click(function(){$("#revisedModal").modal("show")}),-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0?$("#IEwarningModal").modal("show"):$("#disclaimerModal").modal("show"),$("#aboutNav").click(function(){e(),gtag("event","click",{event_category:"About Modal",event_label:"About modal opened"})}),$(".searchBtn searchSubmit").click(function(){search.clear()})}),$(window).resize(function(){$("#legendCollapse").hasClass("in")?(maxLegendHeight=.9*$("#mapDiv").height(),$("#legendElement").css("height",maxLegendHeight),$("#legendElement").css("max-height",maxLegendHeight),maxLegendDivHeight=$("#legendElement").height()-parseInt($("#legendHeading").css("height").replace("px","")),$("#legendDiv").css("max-height",maxLegendDivHeight)):$("#legendElement").css("height","initial")}),$("#printNavButton").click(function(){V()}),$("#printDismissButton").click(function(){if(1==printing){var e=document.getElementById("toast");e.className="show",setTimeout(function(){e.className=e.className.replace("show","")},7e3)}}),$("#printExecuteButton").click(function(e){printing=!0,e.preventDefault(),$(this).button("loading"),Q()}),$("#getDataButton").click(function(){showGetDataModal()}),W(map,"load",function(){var e=map.getScale().toFixed(0);$("#scale")[0].innerHTML=addCommas(e);var t=E.webMercatorToGeographic(map.extent.getCenter());$("#latitude").html(t.y.toFixed(3)),$("#longitude").html(t.x.toFixed(3))}),W(map,"zoom-end",function(){var e=map.getScale().toFixed(0);$("#scale")[0].innerHTML=addCommas(e),$(document).ready(function(){2311162>=e&&$("#printNavButton").prop("disabled",!1),e>2311163&&$("#printNavButton").prop("disabled",!0)})}),W(map,"mouse-move",function(e){if($("#mapCenterLabel").css("display","none"),null!=e.mapPoint){var t=E.webMercatorToGeographic(e.mapPoint);$("#latitude").html(t.y.toFixed(3)),$("#longitude").html(t.x.toFixed(3))}}),W(map,"pan-end",function(){$("#mapCenterLabel").css("display","inline");var e=E.webMercatorToGeographic(map.extent.getCenter());$("#latitude").html(e.y.toFixed(3)),$("#longitude").html(e.x.toFixed(3))});var de=new f("https://server.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer"),pe=new f("https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer"),ue=new f("https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer");W(z.byId("btnStreets"),"click",function(){map.setBasemap("streets"),map.removeLayer(pe),map.removeLayer(de),map.removeLayer(ue),gtag("event","click",{event_category:"Basemap",event_label:"basemap: Streets"})}),W(z.byId("btnHybrid"),"click",function(){map.setBasemap("hybrid"),map.removeLayer(pe),map.removeLayer(de),map.removeLayer(ue),gtag("event","click",{event_category:"Basemap",event_label:"basemap: Hybrid"})}),W(z.byId("btnGray"),"click",function(){map.setBasemap("gray"),map.removeLayer(pe),map.removeLayer(de),map.removeLayer(ue),gtag("event","click",{event_category:"Basemap",event_label:"basemap: Gray"})}),W(z.byId("btnUsgsImgTopo"),"click",function(){map.addLayer(ue,1),map.removeLayer(pe),map.removeLayer(de),gtag("event","click",{event_category:"Basemap",event_label:"basemap: USGS Imagery Topo"})}),W(z.byId("btnUsgsTopo"),"click",function(){map.addLayer(de,1),map.removeLayer(pe),map.removeLayer(ue),gtag("event","click",{event_category:"Basemap",event_label:"basemap: USGS Topo"})}),$("#siteInfoDiv").lobiPanel({unpin:!1,reload:!1,minimize:!1,close:!1,expand:!1,editTitle:!1,Width:500,maxWidth:520,maxHeight:420,minWidth:500,minHeight:370}),$("#siteInfoDiv .dropdown").prepend("<div id='selectionClose' tite='close'><b>X</b></div>"),$("#selectionMin").click(function(){$("#siteInfoDiv").css("visibility","hidden")}),$("#selectionClose").click(function(){$("#siteInfoDiv").css("visibility","hidden"),map.graphics.clear()}),$(document).ready(function(){$("#hidemobileModal").click(function(){$("#mobileModal").modal("hide")}),$("#hideotherModals").click(function(){$("#mobileModal").modal("hide"),$("#welcomeModal").modal("hide"),$("#firstModal").modal("hide"),$("#secondModal").modal("hide"),$("#thirdModal").modal("hide")}),$("#showWelcomeModal").click(function(){$("#welcomeModal").modal("show"),gtag("event","click",{event_category:"Layer Help",event_label:"Layer Help Opened"})}),$("#firstStep").click(function(){$("#firstModal").modal("show"),$("#mobileModal").modal("hide")}),$("#showHelp").click(function(){$("#welcomeModal").modal("show"),$("#mobileModal").modal("show")}),openLayerHelp,$("#openLayerHelp").click(function(){$("#welcomeModal").modal("show"),$("#mobileModal").modal("show")}),$("#secondStep").click(function(){$("#secondModal").modal("show")}),$("#thirdStep").click(function(){$("#thirdModal").modal("show")})}),$("#showLayerWalk").click(function(){setTimeout(function(){var e=0;console.log("checking for backdrops"),$(".modal-backdrop").each(function(){e++,2==e&&($(this).addClass("mobile-modal-backdrop"),console.log("Found mobile backdrop")),1==e&&($(this).addClass("desktop-modal-backdrop"),console.log("Found desktop backdrop"))}),$("<style>").prop("type","text/css").html("                        @media(max-width:768px){                            .desktop-modal-backdrop {                                display: none !important                            }                        }                        @media(min-width:768px){                            .mobile-modal-backdrop {                                display: none !important                            }                        }").appendTo("head")},100)}),$("#showHelp").click(function(){setTimeout(function(){var e=0;console.log("checking for backdrops"),$(".modal-backdrop").each(function(){e++,2==e&&($(this).addClass("mobile-modal-backdrop"),console.log("Found mobile backdrop")),1==e&&($(this).addClass("desktop-modal-backdrop"),console.log("Found desktop backdrop"))}),$("<style>").prop("type","text/css").html("                        @media(max-width:768px){                            .desktop-modal-backdrop {                                display: none !important                            }                        }                        @media(min-width:768px){                            .mobile-modal-backdrop {                                display: none !important                            }                        }").appendTo("head")},50)}),$(document).ready(function(){setTimeout(function(){var e=0;console.log("checking for backdrops"),$(".modal-backdrop").each(function(){e++,1==e&&($(this).addClass("mobile-modal-backdrop"),console.log("Found mobile backdrop")),2==e&&($(this).addClass("desktop-modal-backdrop"),console.log("Found desktop backdrop"))}),$("<style>").prop("type","text/css").html("                        @media(max-width:768px){                            .desktop-modal-backdrop {                                display: none !important                            }                        }                        @media(min-width:768px){                            .mobile-modal-backdrop {                                display: none !important                            }                        }").appendTo("head")},200)}),W(map,"load",function(){map.addLayer(te),map.addLayer(Z),map.addLayer(J),map.addLayer(ee),map.addLayer(K),map.addLayer(ae),re.push(Z,J,ee,K,te,ae),$("#swipeDiv").on(function(){0==map.graphicsLayerIds&&map.removeLayer(Z)});var e=new b({type:"vertical",left:700,map:map,layers:[J]},"swipeDiv");e.startup(),e.on("swipe",function(){document.getElementsByClassName("vertical")[0].style.top="0",gtag("event","click",{event_category:"Slide Tool",event_label:"Slider Used"})});var t=new c({enableButtonMode:!1,enableLabel:!1,enableSearchingAll:!1,enableInfoWindow:!1,showInfoWindowOnSelect:!1,map:map,allPlaceholder:"Enter CBRS unit number (e.g Q01P)",sources:[]},"search");t.startup(),sources=t.get("sources"),sources.push({featureLayer:Z,searchFields:["Unit"],displayField:"Unit",exactMatch:!1,outFields:["Unit"],name:"Revised Units",placeholder:"Enter CBRS unit number (e.g Q01P)",highlightSymbol:new L("https://js.arcgis.com/3.21/esri/dijit/Search/images/search-pointer.png",40,40).setOffset(9,18),maxResults:6,maxSuggestions:6}),sources.push({featureLayer:J,searchFields:["Unit"],displayField:"Unit",exactMatch:!1,outFields:["Unit"],name:"Existing Units",placeholder:"Enter CBRS unit number (e.g Q01P)",highlightSymbol:new L("https://js.arcgis.com/3.21/esri/dijit/Search/images/search-pointer.png",40,40).setOffset(9,18),maxResults:6,maxSuggestions:6}),$("#cbrsNav").click(function(){t.clear()}),W(t,"select-result",function(e){var t=$("#search_input").val();gtag("event","click",{event_category:"Find CBRS",event_label:t}),$("#btnunitDismiss").trigger("click")}),t.set("sources",sources)}),W(map,"click",function(e){void 0===e.graphic&&0==measuring&&$("#outsideCBRS").modal("show")}),W(map,"click",function(e){function t(e){if(e.features.length>0){var t,a=e.features[0];t=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,0,225]),2),new dojo.Color([98,194,204,0])),a.geometry.spatialReference=map.spatialReference;var i=a;i.setSymbol(t),map.graphics.add(i),$("#unitOther").text(a.attributes.Unit)}$("#existingCBRS").modal("show")}if(void 0!=e.graphic&&3==e.graphic._graphicsLayer.layerId){queryTwo=new q,queryTwo.returnGeometry=!0,queryTwo.geometry=e.mapPoint,queryTwo.outFields=["Unit"],queryTask=new D(K.url),queryTask.execute(queryTwo),X("mainDiv");e.mapPoint.getLatitude(),e.mapPoint.getLongitude();queryTask.execute(queryTwo,t)}}),W(map,"click",function(e){function t(t){if(map.graphics.clear(),t.features.length>0){var i,s=t.features[0];i=new esri.symbol.SimpleFillSymbol(esri.symbol.SimpleFillSymbol.STYLE_SOLID,new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([255,0,225]),2),new dojo.Color([98,194,204,0])),s.geometry.spatialReference=map.spatialReference;var n=s;n.setSymbol(i),map.graphics.add(n),$("#unitNum").text(s.attributes.Unit),$("#unitNumOne").text(s.attributes.Unit_1),$("#unitType").text(s.attributes.Unit_Type),$("#unitTypeOne").text(s.attributes.Unit_Type_1),$("#docketURL").html(s.attributes.Docket_URL);var o=s.attributes.Status.toLowerCase();$("#statusTwo").text(o),$("#statusTwo").css("font-weight","normal");var r=s.attributes.Project_URL,l=s.attributes.Project_name;$("#projName").html('<a href="'+r+'" target="_blank">'+l+"</a>"),void 0!=a.Cong_Dist?$("#congressional").text(a.Cong_Dist):$("#congressional").text("District boundaries do not cover all open water areas. Click another area for the district."),$("#congressional").css("font-weight","normal");var c;o.includes("p")&&(c="proposed"),o.includes("f")&&(c="recommended"),s.attributes.Unit===s.attributes.Unit_1&&$("#reclassification").html("You have clicked within an area that is "+c+" to remain within the CBRS as "+s.attributes.Unit_Type_1+" "+s.attributes.Unit_1+"."),""===s.attributes.Unit&&""!==s.attributes.Unit_1&&$("#reclassification").html("You have clicked within an area that is "+c+" for addition to "+s.attributes.Unit_Type_1+" "+s.attributes.Unit_1+"."),""!==s.attributes.Unit&&""===s.attributes.Unit_1&&$("#reclassification").html("You have clicked within an area that is "+c+" for removal from "+s.attributes.Unit_Type+" "+s.attributes.Unit+"."),s.attributes.Unit!==s.attributes.Unit_1&&""!==s.attributes.Unit&&""!==s.attributes.Unit_1&&s.attributes.Unit_Type!==s.attributes.Unit_Type_1&&$("#reclassification").html("You have clicked within an area that is "+c+" for reclassification from "+s.attributes.Unit_Type+" "+s.attributes.Unit+" to "+s.attributes.Unit_Type_1+" "+s.attributes.Unit_1+"."),s.attributes.Unit!==s.attributes.Unit_1&&""!==s.attributes.Unit&&""!==s.attributes.Unit_1&&s.attributes.Unit_Type===s.attributes.Unit_Type_1&&$("#reclassification").html("You have clicked within an area that is "+c+" for transfer from "+s.attributes.Unit_Type+" "+s.attributes.Unit+" to "+s.attributes.Unit_Type_1+" "+s.attributes.Unit_1+".");var d="";if(s.attributes.Status.includes("P")){var p=s.attributes.PR_start_date;startDate=moment(p).calendar(null,{lastDay:"L",sameDay:"L",nextDay:"L",lastWeek:"L",nextWeek:"L",sameElse:"L"});var u=s.attributes.PR_end_date;endDate=moment(u).calendar(null,{lastDay:"L",sameDay:"L",nextDay:"L",lastWeek:"L",nextWeek:"L",sameElse:"L"}),prDates=startDate+" &#8211; "+endDate,$("#status").html("<strong>"+s.attributes.Status+"</strong>&#8211; Public review open from "+prDates+'. Visit: <a href="'+s.attributes.Docket_URL+'" target="_blank">'+s.attributes.Docket_URL+"</a> to make comments during the comment period and/or view submitted comments."),$("#status").css("font-weight","normal"),$("#finalRecText").hide()}if(s.attributes.Status.includes("F")){var m=s.attributes.Transmittal_Date;d=moment(m).calendar(null,{lastDay:"L",sameDay:"L",nextDay:"L",lastWeek:"L",nextWeek:"L",sameElse:"L"}),$("#status").html("<strong>"+s.attributes.Status+"</strong>&#8211; The final recommended boundaries for this project were transmitted to Congress on "+d+". These boundaries will become effective only if adopted by Congress through legislation."),$("#status").css("font-weight","normal"),$("#finalRecText").html('View other information related to this project, including final recommended maps and responses to public comments: <a href="'+r+'" target="_blank">'+r+"</a>"),$("#finalRecText").css("font-weight","normal"),$("#finalRecText").show()}$("#unitName").text(s.attributes.Name),$("#changeTyp").text(s.attributes.Change_Type),$("#siteUnit").text(s.attributes.Unit);var g=s.attributes.Summary_URL;$("#summaryUrl").html("View the Service&#146s Summary of "+s.attributes.Status+' Changes for this unit: <a href="'+g+'" target="_blank">'+g+"</a>"),$("#summaryUrl").css("font-weight","normal"),$("#siteInfoDiv").css("visibility","visible");var y=$("#siteInfoDiv").data("lobiPanel"),f=$(document).height(),h=$(document).width(),b=.9,v=f*b,w=h*b;500>f&&$("#siteInfoDiv").height(v),500>h&&$("#siteInfoDiv").width(w);var L=e.x,k=e.y;y.setPosition(L,k),1==y.isPinned()&&y.unpin(),map.graphics.clear()}}if(1==polyClicked)return void(polyClicked=!1);if(null==measurement.activeTool&&(map.graphics.clear(),void 0!=e.graphic)){var a=e.graphic.attributes;A=new q,A.returnGeometry=!0,A.geometry=e.mapPoint,A.outFields=["Unit","Name","Unit_Type","Change_Type","Summary_URL","Project_name","Project_URL","Status","Docket_URL","Unit_1","Unit_Type_1","PR_start_date","PR_end_date","Transmittal_Date"],queryTask=new D(ee.url),queryTask.execute(A),X("mainDiv");e.mapPoint.getLatitude(),e.mapPoint.getLongitude();queryTask.execute(A,t)}}),$(document).ready(function(){function e(){$("#cbrsModal").modal("show")}$("#cbrsNav").click(function(){e()});var t=0;$("#dijit_form_ToggleButton_1").click(function(){t++,measuring=t%2?!0:!1})}),$("#clearSelection").click(function(){map.graphics.clear()}),map.on("load",function(){map.infoWindow.set("highlight",!1),map.infoWindow.set("titleInBody",!1)}),$(document).ready(function(){}),$("#faq1header").click(function(){$("#faq1body").slideToggle(250)}),$("#faq2header").click(function(){$("#faq2body").slideToggle(250)}),$("#faq3header").click(function(){$("#faq3body").slideToggle(250)}),$("#faq4header").click(function(){$("#faq4body").slideToggle(250)}),$("#faq5header").click(function(){$("#faq5body").slideToggle(250)}),$("#faq6header").click(function(){$("#faq6body").slideToggle(250)}),$("#faq7header").click(function(){$("#faq7body").slideToggle(250)}),$("#faq8header").click(function(){$("#faq8body").slideToggle(250)}),$("#faq9header").click(function(){$("#faq9body").slideToggle(250)}),$("#faq10header").click(function(){$("#faq10body").slideToggle(250)}),$("#faq11header").click(function(){$("#faq11body").slideToggle(250)}),$(".fullsize").click(function(){var e="<img src='"+$(this).attr("src")+"'/>",t=window.open("data:text/html,"+encodeURIComponent(e),"_blank");t.focus()}),$("#faq1header").click(function(){"none"==$("#angle1").css("transform")?$("#angle1").css("transform","rotate(90deg)"):$("#angle1").css("transform","")}),$("#faq2header").click(function(){"none"==$("#angle2").css("transform")?$("#angle2").css("transform","rotate(90deg)"):$("#angle2").css("transform","")}),$("#faq3header").click(function(){"none"==$("#angle3").css("transform")?$("#angle3").css("transform","rotate(90deg)"):$("#angle3").css("transform","")}),$("#faq4header").click(function(){"none"==$("#angle4").css("transform")?$("#angle4").css("transform","rotate(90deg)"):$("#angle4").css("transform","")}),$("#faq5header").click(function(){"none"==$("#angle5").css("transform")?$("#angle5").css("transform","rotate(90deg)"):$("#angle5").css("transform","")}),$("#faq6header").click(function(){"none"==$("#angle6").css("transform")?$("#angle6").css("transform","rotate(90deg)"):$("#angle6").css("transform","")}),$("#faq7header").click(function(){"none"==$("#angle7").css("transform")?$("#angle7").css("transform","rotate(90deg)"):$("#angle7").css("transform","")}),$("#faq8header").click(function(){"none"==$("#angle8").css("transform")?$("#angle8").css("transform","rotate(90deg)"):$("#angle8").css("transform","")}),$("#faq9header").click(function(){"none"==$("#angle9").css("transform")?$("#angle9").css("transform","rotate(90deg)"):$("#angle9").css("transform","")}),$("#faq10header").click(function(){"none"==$("#angle10").css("transform")?$("#angle10").css("transform","rotate(90deg)"):$("#angle10").css("transform","")}),$("#faq11header").click(function(){"none"==$("#angle11").css("transform")?$("#angle11").css("transform","rotate(90deg)"):$("#angle11").css("transform","")}),printTitle,$(document).ready(function(){function e(){$("#siteInfoDiv").modal("hide"),$("#outsideCBRS").modal("hide")}function t(){$("#faqModal").modal("show")}function t(){$("#geosearchModal").modal("show")}$("#siteModal").load(function(){e(),alert("worked")}),$("#printTitle").keypress(function(e){var t=e.keyCode,a=t>64&&91>t||t>96&&123>t||8==t||32==t||t>=48&&57>=t;return a?void 0:!1}),$("#faqNav").click(function(){$("#faqModal").modal("show")}),$("#geosearchNav").click(function(){function e(){$("#searchDownModal").modal("show")}var a=!0;try{search_api}catch(i){a=!1,console.log("did not work")}a?(t(),console.log("init"),search_api.create("geosearch",{on_result:function(e){require(["esri/geometry/Extent"],function(t){var a=["GNIS_MAJOR","GNIS_MINOR","ZIPCODE","AREACODE"],i=a.indexOf(e.result.properties.Source);$("#geosearchModal").modal("hide"),-1==i?map.setExtent(new esri.geometry.Extent({xmin:e.result.properties.LonMin,ymin:e.result.properties.LatMin,xmax:e.result.properties.LonMax,ymax:e.result.properties.LatMax,spatialReference:{wkid:4326}}),!0):require(["esri/geometry/Point"],function(t){map.centerAndZoom(new t(e.result.properties.Lon,e.result.properties.Lat),12)}),gtag("event","click",{event_category:"Find Location",event_label:e.result.properties.Name+", "+e.result.properties.Lon+", "+e.result.properties.Lat})})},include_usgs_sw:!0,include_usgs_gw:!0,include_usgs_sp:!0,include_usgs_at:!0,include_usgs_ot:!0,include_huc2:!0,include_huc4:!0,include_huc6:!0,include_huc8:!0,include_huc10:!0,include_huc12:!0,on_failure:function(e){$("#test").html("Sorry, a location could not be found in search for '"+e.val()+"'"),$("#invalidSearchLocationModal").modal("show")}})):e()}),$("#html").niceScroll(),$("#sidebar").niceScroll(),$("#sidebar").scroll(function(){$("#sidebar").getNiceScroll().resize()}),$("#legendElement").click(function(){setTimeout(function(){var e=0;console.log("checking for esri table class"),$("table.esriLegendLayer").each(function(){e++,1==e&&console.log("found esri labels"),2==e&&($(this).addClass("esriLegendOther"),console.log("Found the Other class"))}),$("<style>").prop("type","text/css").html("                            {                            .esriLegendOther {                                display: none !important                            }                        }                        ").appendTo("head")},370)}),$("#layersPanel").click(function(){setTimeout(function(){var e=0;console.log("checking for esri table class"),$("table.esriLegendLayer").each(function(){e++,1==e&&console.log("found esri labels"),2==e&&($(this).addClass("esriLegendOther"),console.log("Found the Other class"))}),$("<style>").prop("type","text/css").html("                            {                            .esriLegendOther {                                display: none !important                            }                        }                        ").appendTo("head")})}),maxLegendHeight=.9*$("#mapDiv").height(),$("#legendElement").css("max-height",maxLegendHeight),maxLegendDivHeight=maxLegendHeight-parseInt($("#legendHeading").css("height").replace("px","")),$("#legendDiv").css("max-height",maxLegendDivHeight),$("#legendCollapse").on("shown.bs.collapse",function(){if(0==legendDiv.innerHTML.length){var e=new n({map:map,layerInfos:legendLayers},"legendDiv");e.startup(),$("#legendDiv").niceScroll()}}),$("#legendCollapse").on("hide.bs.collapse",function(){$("#legendElement").css("height","initial")}),$("#measurementCollapse").on("shown.bs.collapse",function(){$("#measureLabel").show()}),$("#measurementCollapse").on("hide.bs.collapse",function(){window.innerWidth<=767&&$("#measureLabel").hide()})}),require(["esri/InfoTemplate","esri/tasks/locator","esri/tasks/query","esri/tasks/QueryTask","esri/graphicsUtils","esri/geometry/Point","esri/geometry/Extent","esri/layers/ArcGISDynamicMapServiceLayer","esri/layers/ArcGISImageServiceLayer","esri/layers/FeatureLayer","esri/layers/WMSLayer","esri/layers/WMSLayerInfo","esri/tasks/GeometryService","esri/dijit/LayerSwipe","dijit/form/CheckBox","dijit/form/RadioButton","dojo/query","dojo/dom","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/on"],function(e,t,a,i,s,n,o,r,l,c,d,p,u,m,g,y,f,h,b,v,w,L){function k(t,a,i,s,n,o,r){if(map.addLayer(i),"aoi"==i.id&&L(i,"load",function(t){L(i,"click",function(t){aoiClicked=!0;var a=t.graphic.attributes.HYPERLINK_2;if("None"==a){var s=new e("${NAME}","Type: ${TYPE}<br/>Location Website: <a target='_blank' href='${HYPERLINK}'>click here</a><br/>Water Summary Report: <a target='_blank' href='${WATER_SUMMARY_REPORT}'>click here</a><br/>Wildlife Action Plan: <a target='_blank' href='${STATE_ACTION_PLAN}'>click here</a><br/>");i.setInfoTemplate(s)}else{var s=new e("${NAME}","Type: ${TYPE}<br/>Ramsar: <a id='ramsarLink' target='_blank' href='${HYPERLINK_2}'>click here</a><br/>Location Website: <a target='_blank' href='${HYPERLINK}'>click here</a><br/>Water Summary Report: <a target='_blank' href='${WATER_SUMMARY_REPORT}'>click here</a><br/>Wildlife Action Plan: <a target='_blank' href='${STATE_ACTION_PLAN}'>click here</a><br/>");i.setInfoTemplate(s)}})}),S.push([n,camelize(s),i]),n){if(!$("#"+camelize(n)).length){var l;if("Data Source"==n)var l=$('<div id="'+camelize(n+" Root")+'" class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default active" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-check-square-o"></i>&nbsp;&nbsp;'+n+'<span id="info'+camelize(n)+'" title="Data Source identifies the scale, year and emulsion of the imagery that was used to map the wetlands and riparian areas for a given area. It also identifies areas that have Scalable data, which is an interim data product in areas of the nation where standard compliant wetland data is not yet available. Click for more info on Scalable data." class="glyphspan glyphicon glyphicon-question-sign pull-right"></span><span id="opacity'+camelize(n)+'" style="padding-right: 5px" class="glyphspan glyphicon glyphicon-adjust pull-right"></span></button> </div>');else var l=$('<div id="'+camelize(n+" Root")+'" class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default active" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-check-square-o"></i>&nbsp;&nbsp;'+n+"</button> </div>");l.click(function(e){l.find("i.glyphspan").toggleClass("fa-check-square-o fa-square-o"),$.each(S,function(e,t){var a=map.getLayer(t[2].id);if(t[0]==n)if($("#"+t[1]).find("i.glyphspan").hasClass("fa-dot-circle-o")&&l.find("i.glyphspan").hasClass("fa-check-square-o")){console.log("adding layer: ",t[1]),map.addLayer(t[2]);var a=map.getLayer(t[2].id);a.setVisibility(!0)}else if(l.find("i.glyphspan").hasClass("fa-square-o")){console.log("removing layer: ",t[1]);var a=map.getLayer(t[2].id);a.setVisibility(!1)}})});var c=$('<div id="'+camelize(n)+'" class="btn-group-vertical" data-toggle="buttons"></div>');$("#toggle").append(c)}if(i.visible)var d=$('<div id="'+camelize(s)+'" class="btn-group-vertical lyrTog radioTog" style="cursor: pointer;" data-toggle="buttons"> <label class="btn btn-default"  style="font-weight: bold;text-align: left"> <input type="radio" name="'+camelize(n)+'" autocomplete="off"><i class="glyphspan fa fa-dot-circle-o '+camelize(n)+'"></i>&nbsp;&nbsp;'+s+"</label> </div>");else var d=$('<div id="'+camelize(s)+'" class="btn-group-vertical lyrTog radioTog" style="cursor: pointer;" data-toggle="buttons"> <label class="btn btn-default"  style="font-weight: bold;text-align: left"> <input type="radio" name="'+camelize(n)+'" autocomplete="off"><i class="glyphspan fa fa-circle-o '+camelize(n)+'"></i>&nbsp;&nbsp;'+s+"</label> </div>");
$("#"+camelize(n)).append(d),d.click(function(e){if($(this).find("i.glyphspan").hasClass("fa-circle-o")){$(this).find("i.glyphspan").toggleClass("fa-dot-circle-o fa-circle-o");var t=$(this)[0].id;$.each(S,function(e,a){if(a[0]==n)if(a[1]==t&&$("#"+camelize(n+" Root")).find("i.glyphspan").hasClass("fa-check-square-o")){console.log("adding layer: ",a[1]),map.addLayer(a[2]);var i=map.getLayer(a[2].id);i.setVisibility(!0)}else if(a[1]==t&&$("#"+camelize(n+" Root")).find("i.glyphspan").hasClass("fa-square-o"))console.log("group heading not checked");else{console.log("removing layer: ",a[1]);var i=map.getLayer(a[2].id);i.setVisibility(!1),$("#"+a[1]).find("i.glyphspan").hasClass("fa-dot-circle-o")&&$("#"+a[1]).find("i.glyphspan").toggleClass("fa-dot-circle-o fa-circle-o")}})}})}else if(r.includeInLayerList){if(i.visible&&r.hasOpacitySlider)var d=$('<div class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-check-square-o"></i>&nbsp;&nbsp;'+s+'<span id="opacity'+camelize(s)+'" style="padding-right: 5px" class="glyphspan glyphicon glyphicon-adjust pull-right"></span></button></div>');else if(!i.visible&&r.hasOpacitySlider)var d=$('<div class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-square-o"></i>&nbsp;&nbsp;'+s+'<span id="info'+camelize(s)+'" title="more info" class="glyphspan glyphicon glyphicon-question-sign pull-right"></span><span id="opacity'+camelize(s)+'" style="padding-right: 5px" class="glyphspan glyphicon glyphicon-adjust pull-right"></span></button></div>');else if(i.visible&&void 0!==r.hasOpacitySlider&&1==r.hasOpacitySlider)var d=$('<div class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-check-square-o"></i>&nbsp;&nbsp;'+s+'<span id="info'+camelize(s)+'" title="more info" class="glyphspan glyphicon glyphicon-question-sign pull-right"></button></span></div>');else if(i.visible||void 0===r.hasOpacitySlider||1!=r.hasOpacitySlider)if(i.visible)var d=$('<div class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-check-square-o"></i>&nbsp;&nbsp;'+s+'<span id="info'+camelize(s)+'" title="more info" class="glyphspan glyphicon glyphicon-question-sign pull-right"></span><span id="opacity'+camelize(s)+'" class="glyphspan glyphicon glyphicon-adjust pull-right"></button></span></div>');else if(i.visible)if(i.visible)var d=$('<div class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default active" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-check-square-o"></i>&nbsp;&nbsp;'+s+"</button></span></div>");else var d=$('<div class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-square-o"></i>&nbsp;&nbsp;'+s+"</button> </div>");else var d=$('<div class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-square-o"></i>&nbsp;&nbsp;'+s+'<span id="info'+camelize(s)+'" title="more info" class="glyphspan glyphicon glyphicon-question-sign pull-right"></button></span></div>');else var d=$('<div class="btn-group-vertical lyrTog" style="cursor: pointer;" data-toggle="buttons"> <button type="button" class="btn btn-default active" aria-pressed="true" style="font-weight: bold;text-align: left"><i class="glyphspan fa fa-square-o"></i>&nbsp;&nbsp;'+s+'<span id="info'+camelize(s)+'" title="more info" class="glyphspan glyphicon glyphicon-question-sign pull-right"></span><span id="opacity'+camelize(s)+'" class="glyphspan glyphicon glyphicon-adjust pull-right"></button></span></div>');d.click(function(e){$(this).find("i.glyphspan").toggleClass("fa-check-square-o fa-square-o"),$(this).find("button").button("toggle"),i.visible?i.setVisibility(!1):i.setVisibility(!0),r.otherLayersToggled&&$.each(r.otherLayersToggled,function(e,t){var a=map.getLayer(t);a.setVisibility(i.visible)})})}if(void 0!==a){var p=camelize(t);if(!$("#"+p).length){if(a)var u=$('<div id="'+p+'"><div class="alert alert-info" role="alert"><strong>'+t+"</strong></div></div>");else var u=$('<div id="'+p+'"></div>');$("#toggle").append(u)}if(n){if($("#"+p).append(l),$("#"+p).append(c),void 0!==r.moreinfo&&r.moreinfo){var m="#info"+camelize(n),g=$(m);g.click(function(e){window.open(r.moreinfo,"_blank"),e.preventDefault(),e.stopPropagation()})}if($("#opacity"+camelize(n)).length>0){var m="#opacity"+camelize(n),y=$(m);y.click(function(e){e.preventDefault(),e.stopPropagation(),$(".opacitySlider").remove();var t=map.getLayer(o.id).opacity,a=$('<div class="opacitySlider"><label id="opacityValue">Opacity: '+t+'</label><label class="opacityClose pull-right">X</label><input id="slider" type="range"></div>');$("body").append(a),$("#slider")[0].value=100*t,$(".opacitySlider").css("left",event.clientX-180),$(".opacitySlider").css("top",event.clientY-50),$(".opacitySlider").mouseleave(function(){$(".opacitySlider").remove()}),$(".opacityClose").click(function(){$(".opacitySlider").remove()}),$("#slider").change(function(e){var t=$("#slider")[0].value/100;console.log("o: "+t),$("#opacityValue").html("Opacity: "+t),map.getLayer(o.id).setOpacity(t),r.otherLayersToggled&&$.each(r.otherLayersToggled,function(e,a){var i=map.getLayer(a);i.setOpacity(t)})})})}}else{if($("#"+p).append(d),void 0!==r.moreinfo&&r.moreinfo){var m="#info"+camelize(s),g=$(m);g.click(function(e){window.open(r.moreinfo,"_blank"),e.preventDefault(),e.stopPropagation()})}$("#opacity"+camelize(s)).length>0&&$("#opacity"+camelize(s)).click(function(e){e.preventDefault(),e.stopPropagation(),$(".opacitySlider").remove();var t=map.getLayer(o.id).opacity,a=$('<div class="opacitySlider"><label id="opacityValue">Opacity: '+t+'</label><label class="opacityClose pull-right">X</label><input id="slider" type="range"></div>');$("body").append(a),$("#slider")[0].value=100*t,$(".opacitySlider").css("left",event.clientX-180),$(".opacitySlider").css("top",event.clientY-50),$(".opacitySlider").mouseleave(function(){$(".opacitySlider").remove()}),$(".opacityClose").click(function(){$(".opacitySlider").remove()}),$("#slider").change(function(e){var t=$("#slider")[0].value/100;console.log("o: "+t),$("#opacityValue").html("Opacity: "+t),map.getLayer(o.id).setOpacity(t),r.otherLayersToggled&&$.each(r.otherLayersToggled,function(e,a){var i=map.getLayer(a);i.setOpacity(t)})})})}}else if($("#toggle").append(d),void 0!==r.moreinfo&&r.moreinfo){var m="#info"+camelize(s),g=$(m);g.click(function(e){alert(e.currentTarget.id),e.preventDefault(),e.stopPropagation()})}}var S=(new u("https://fwsmapper.wim.usgs.gov/arcgis/rest/services/Utilities/Geometry/GeometryServer"),[]);$.each(allLayers,function(e,t){console.log("processing: ",t.groupHeading),$.each(t.layers,function(e,a){var i="";if(a.wimOptions.exclusiveGroupName&&(i=a.wimOptions.exclusiveGroupName),"agisFeature"===a.wimOptions.layerType){var s=new c(a.url,a.options);void 0!==a.wimOptions.renderer&&s.setRenderer(a.wimOptions.renderer),a.wimOptions&&1==a.wimOptions.includeLegend&&legendLayers.unshift({layer:s,title:e}),k(t.groupHeading,t.showGroupHeading,s,e,i,a.options,a.wimOptions)}else if("agisWMS"===a.wimOptions.layerType){var s=new d(a.url,{resourceInfo:a.options.resourceInfo,visibleLayers:a.options.visibleLayers},a.options);a.wimOptions&&1==a.wimOptions.includeLegend&&legendLayers.unshift({layer:s,title:e}),k(t.groupHeading,t.showGroupHeading,s,e,i,a.options,a.wimOptions)}else if("agisDynamic"===a.wimOptions.layerType){var s=new r(a.url,a.options);if(a.visibleLayers&&s.setVisibleLayers(a.visibleLayers),a.wimOptions&&a.wimOptions.layerDefinitions){var n=[];$.each(a.wimOptions.layerDefinitions,function(e,t){n[e]=t}),s.setLayerDefinitions(n)}a.wimOptions&&1==a.wimOptions.includeLegend&&legendLayers.unshift({layer:s,title:e}),k(t.groupHeading,t.showGroupHeading,s,e,i,a.options,a.wimOptions)}else if("agisImage"===a.wimOptions.layerType){var s=new l(a.url,a.options);a.wimOptions&&1==a.wimOptions.includeLegend&&legendLayers.unshift({layer:s,title:e}),a.visibleLayers&&s.setVisibleLayers(a.visibleLayers),k(t.groupHeading,t.showGroupHeading,s,e,i,a.options,a.wimOptions)}})})})}),$(".close-alert").click(function(){$(this).parent().slideUp(250)}),$("#legendElement").click(function(){setTimeout(function(){var e=0;console.log("checking for esri table class"),$("table.esriLegendLayer").each(function(){e++,1==e&&console.log("found esri labels"),2==e&&($(this).addClass("esriLegendOther"),console.log("Found the Other class"))}),$("<style>").prop("type","text/css").html("                            {                            .esriLegendOther {                                display: none !important                            }                        }                        ").appendTo("head")},500)});